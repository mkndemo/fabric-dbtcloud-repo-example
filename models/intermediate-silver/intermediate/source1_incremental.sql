{{ config(
    materialized='incremental',
    unique_key='hash'
) }}

SELECT
    s.pk,
    s.Column_1,
    s.Column_2,
    s.Column_3,
    s.Column_4,
    s.Column_5,
    s.Column_6,
    s.Column_7,
    s.Column_8,
    s.Column_9,
    s.Column_10,
    s.Column_11,
    s.Column_12,
    s.Column_13,
    s.Column_14,
    s.Column_15,
    s.Column_16,
    s.Column_17,
    s.Column_18,
    s.Column_19,
    s.Column_20,
    s.Column_21,
    s.Column_22,
    s.Column_23,
    s.Column_24,
    s.Column_25,
    s.Column_26,
    s.Column_27,
    s.Column_28,
    s.Column_29,
    s.Column_30,
    s.Column_31,
    s.Column_32,
    s.Column_33,
    s.Column_34,
    s.Column_35,
    s.Column_36,
    s.Column_37,
    s.Column_38,
    s.Column_39,
    s.Column_40,
    s.Column_41,
    s.Column_42,
    s.Column_43,
    s.Column_44,
    s.Column_45,
    s.Column_46,
    s.Column_47,
    s.Column_48,
    s.Column_49,
    s.Column_50,
    s.Column_51,
    s.Column_52,
    s.Column_53,
    s.Column_54,
    s.Column_55,
    s.Column_56,
    s.Column_57,
    s.Column_58,
    s.Column_59,
    s.Column_60,
    s.Column_61,
    s.Column_62,
    s.Column_63,
    s.Column_64,
    s.Column_65,
    s.Column_66,
    s.Column_67,
    s.Column_68,
    s.Column_69,
    s.Column_70,
    s.Column_71,
    s.Column_72,
    s.Column_73,
    s.Column_74,
    s.Column_75,
    s.Column_76,
    s.Column_77,
    s.Column_78,
    s.Column_79,
    s.Column_80,
    s.Column_81,
    s.Column_82,
    s.Column_83,
    s.Column_84,
    s.Column_85,
    s.Column_86,
    s.Column_87,
    s.Column_88,
    s.Column_89,
    s.Column_90,
    s.Column_91,
    s.Column_92,
    s.Column_93,
    s.Column_94,
    s.Column_95,
    s.Column_96,
    s.Column_97,
    s.Column_98,
    s.Column_99,
    s.Column_100,
    s.Column_101,
    s.Column_102,
    s.Column_103,
    s.Column_104,
    s.Column_105,
    s.Column_106,
    s.Column_107,
    s.Column_108,
    s.Column_109,
    s.Column_110,
    s.Column_111,
    s.Column_112,
    s.Column_113,
    s.Column_114,
    s.Column_115,
    s.Column_116,
    s.Column_117,
    s.Column_118,
    s.Column_119,
    s.Column_120,
    s.Column_121,
    s.Column_122,
    s.Column_123,
    s.Column_124,
    s.Column_125,
    s.Column_126,
    s.Column_127,
    s.Column_128,
    s.Column_129,
    s.Column_130,
    s.Column_131,
    s.Column_132,
    s.Column_133,
    s.Column_134,
    s.Column_135,
    s.Column_136,
    s.Column_137,
    s.Column_138,
    s.Column_139,
    s.Column_140,
    s.Column_141,
    s.Column_142,
    s.Column_143,
    s.Column_144,
    s.Column_145,
    s.Column_146,
    s.Column_147,
    s.Column_148,
    s.Column_149,
    s.Column_150,
    s.Column_151,
    s.Column_152,
    s.Column_153,
    s.Column_154,
    s.Column_155,
    s.Column_156,
    s.Column_157,
    s.Column_158,
    s.Column_159,
    s.Column_160,
    s.Column_161,
    s.Column_162,
    s.Column_163,
    s.Column_164,
    s.Column_165,
    s.Column_166,
    s.Column_167,
    s.Column_168,
    s.Column_169,
    s.Column_170,
    s.Column_171,
    s.Column_172,
    s.Column_173,
    s.Column_174,
    s.Column_175,
    s.Column_176,
    s.Column_177,
    s.Column_178,
    s.Column_179,
    s.Column_180,
    s.Column_181,
    s.Column_182,
    s.Column_183,
    s.Column_184,
    s.Column_185,
    s.Column_186,
    s.Column_187,
    s.Column_188,
    s.Column_189,
    s.Column_190,
    s.Column_191,
    s.Column_192,
    s.Column_193,
    s.Column_194,
    s.Column_195,
    s.Column_196,
    s.Column_197,
    s.Column_198,
    s.Column_199,
    s.Column_200,
    s.updated_at,
    s.hash,
    '{{ invocation_id }}' as batch_id
FROM {{ ref('stg_source_tables__source1') }} s
{% if is_incremental() %}
WHERE NOT EXISTS (SELECT 1 FROM {{ this }} WHERE hash = s.hash)
{% endif %}
-- LEFT JOIN {{ this }} t ON s.hash = t.hash